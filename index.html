<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagn√≥stico de Cole√ß√£o - Vers√£o Gratuita</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1e1e1e 0%, #2d2d2d 100%);
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
        }

        header {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }

        h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            background: linear-gradient(90deg, #d4af37, #f4e5b1);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            color: #999;
            font-size: 1.1em;
        }

        .badge {
            display: inline-block;
            background: rgba(212, 175, 55, 0.2);
            color: #d4af37;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85em;
            margin-top: 10px;
            border: 1px solid rgba(212, 175, 55, 0.3);
        }

        /* QUIZ STYLES */
        .quiz-section {
            display: none;
        }

        .quiz-section.active {
            display: block;
        }

        .question-card {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(212, 175, 55, 0.3);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            text-align: center;
        }

        .question-number {
            color: #d4af37;
            font-size: 0.9em;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .question-title {
            color: white;
            font-size: 1.8em;
            font-weight: 700;
            margin-bottom: 40px;
            line-height: 1.4;
        }

        .options-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .option-btn {
            background: rgba(212, 175, 55, 0.1);
            border: 2px solid rgba(212, 175, 55, 0.3);
            color: white;
            padding: 20px;
            border-radius: 12px;
            font-size: 1em;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .option-btn:hover {
            background: rgba(212, 175, 55, 0.2);
            border-color: #d4af37;
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(212, 175, 55, 0.3);
        }

        .option-btn.selected {
            background: linear-gradient(135deg, #d4af37, #f4e5b1);
            color: #1e1e1e;
            border-color: #d4af37;
        }

        .next-btn {
            background: linear-gradient(135deg, #d4af37, #f4e5b1);
            color: #1e1e1e;
            border: none;
            padding: 15px 40px;
            border-radius: 10px;
            font-size: 1.1em;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            opacity: 0.5;
            pointer-events: none;
        }

        .next-btn.enabled {
            opacity: 1;
            pointer-events: all;
        }

        .next-btn.enabled:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 20px rgba(212, 175, 55, 0.5);
        }

        .section-title {
            color: white;
            font-size: 1.8em;
            margin: 40px 0 20px 0;
            text-align: center;
        }

        .interactive-note {
            background: rgba(100, 150, 255, 0.1);
            border: 2px solid rgba(100, 150, 255, 0.3);
            border-radius: 10px;
            padding: 20px;
            margin-top: 40px;
            text-align: center;
            color: #9bc4ff;
        }

        .section-title {
            display: flex;
            justify-content: center;
            margin-top: 30px;
        }

        .balance-card {
            background: rgba(255, 255, 255, 0.05);
            border: 2px solid rgba(212, 175, 55, 0.3);
            border-radius: 15px;
            padding: 40px;
            max-width: 800px;
            width: 100%;
        }

        .balance-title {
            color: #d4af37;
            font-size: 1.8em;
            margin-bottom: 15px;
            text-align: center;
        }

        .balance-description {
            color: #ccc;
            text-align: center;
            margin-bottom: 30px;
            line-height: 1.6;
        }

        .context-section {
            background: rgba(100, 150, 255, 0.1);
            border: 2px solid rgba(100, 150, 255, 0.3);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        #grid-contexto-cta .context-section {
            margin-bottom: 0;
            height: 100%;
        }

        .context-title {
            color: #9bc4ff;
            font-size: 1.2em;
            font-weight: 600;
            margin-bottom: 15px;
            text-align: center;
        }

        .context-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .context-item label {
            color: #9bc4ff;
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .context-item input[type="text"],
        .context-item input[type="number"] {
            width: 100%;
            padding: 10px;
            font-size: 1em;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(100, 150, 255, 0.3);
            border-radius: 5px;
            color: white;
        }

        .context-item input[type="text"]:focus,
        .context-item input[type="number"]:focus {
            outline: none;
            border-color: #9bc4ff;
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 10px;
            color: #ccc;
            cursor: pointer;
            padding: 8px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 5px;
            transition: all 0.2s ease;
        }

        .checkbox-label:hover {
            background: rgba(100, 150, 255, 0.1);
        }

        .checkbox-label input[type="checkbox"] {
            width: 18px;
            height: 18px;
            cursor: pointer;
        }

        .family-counter {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 15px;
            margin-bottom: 30px;
        }

        @media (max-width: 768px) {
            .family-counter {
                grid-template-columns: 1fr;
            }
        }

        .counter-item {
            background: rgba(212, 175, 55, 0.1);
            padding: 15px;
            border-radius: 10px;
            border: 1px solid rgba(212, 175, 55, 0.2);
        }

        .counter-item label {
            color: #d4af37;
            display: block;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .counter-item input {
            width: 100%;
            padding: 10px;
            font-size: 1.2em;
            text-align: center;
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(212, 175, 55, 0.3);
            border-radius: 5px;
            color: white;
        }

        .counter-item input:focus {
            outline: none;
            border-color: #d4af37;
        }

        .analyze-btn {
            width: 100%;
            padding: 15px;
            font-size: 1.2em;
            font-weight: 600;
            background: linear-gradient(90deg, #d4af37, #f4e5b1);
            color: #1e1e1e;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .analyze-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(212, 175, 55, 0.4);
        }

        .result-box {
            margin-top: 30px;
            background: rgba(212, 175, 55, 0.1);
            border: 2px solid #d4af37;
            border-radius: 10px;
            padding: 25px;
        }

        .result-title {
            color: #d4af37;
            font-size: 1.3em;
            font-weight: 600;
            margin-bottom: 20px;
            text-align: center;
        }

        .result-content {
            color: white;
            font-size: 1.1em;
            margin-bottom: 15px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
        }

        .result-advice {
            color: #ccc;
            line-height: 1.8;
            margin-bottom: 15px;
            padding: 15px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
        }

        .result-next {
            color: #9bc4ff;
            background: rgba(100, 150, 255, 0.1);
            border: 2px solid rgba(100, 150, 255, 0.3);
            padding: 15px;
            border-radius: 8px;
            line-height: 1.8;
        }

        .result-next strong {
            color: #fff;
        }

        @media (max-width: 768px) {
            h1 {
                font-size: 1.8em;
            }
            
            .grid {
                grid-template-columns: 1fr;
            }

            .options-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>DIAGN√ìSTICO DE COLE√á√ÉO</h1>
            <p class="subtitle">Descubra se sua cole√ß√£o est√° equilibrada</p>
            <span class="badge">üÜì VERS√ÉO GRATUITA</span>
        </header>

        <!-- QUIZ SECTION - Perguntas de qualifica√ß√£o -->
        <div id="quiz-1" class="quiz-section active">
            <div class="question-card">
                <div class="question-number">PERGUNTA 1 DE 3</div>
                <div class="question-title">Voc√™ j√° usa perfume?</div>
                <div class="options-grid">
                    <button class="option-btn" onclick="selectOption(1, 'sim-sempre', this)">Sim, sempre</button>
                    <button class="option-btn" onclick="selectOption(1, 'quando-lembro', this)">Quando lembro!</button>
                    <button class="option-btn" onclick="selectOption(1, 'nao-ligo', this)">N√£o ligo muito!</button>
                    <button class="option-btn" onclick="selectOption(1, 'nao-sei', this)">N√£o sei nada de perfumaria</button>
                </div>
                <button class="next-btn" id="next-1" onclick="nextQuestion(1)">Pr√≥xima ‚Üí</button>
            </div>
        </div>

        <div id="quiz-2" class="quiz-section">
            <div class="question-card">
                <div class="question-number">PERGUNTA 2 DE 3</div>
                <div class="question-title">Qual sua maior dificuldade ao escolher um perfume?</div>
                <div class="options-grid">
                    <button class="option-btn" onclick="selectOption(2, 'mesmo-tipo', this)">Compro sempre do mesmo tipo</button>
                    <button class="option-btn" onclick="selectOption(2, 'muitas-opcoes', this)">Muitas op√ß√µes e n√£o sei qual comprar</button>
                    <button class="option-btn" onclick="selectOption(2, 'influenciador', this)">Escuto o vendedor/influenciador e acabo perdendo dinheiro</button>
                    <button class="option-btn" onclick="selectOption(2, 'nao-compro', this)">Eu n√£o compro nunca</button>
                </div>
                <button class="next-btn" id="next-2" onclick="nextQuestion(2)">Pr√≥xima ‚Üí</button>
            </div>
        </div>

        <div id="quiz-3" class="quiz-section">
            <div class="question-card">
                <div class="question-number">PERGUNTA 3 DE 3</div>
                <div class="question-title">Qual seu or√ßamento para perfumes?</div>
                <div class="options-grid">
                    <button class="option-btn" onclick="selectOption(3, 'ate-350', this)">At√© R$350</button>
                    <button class="option-btn" onclick="selectOption(3, '350-1500', this)">R$350 a R$1500</button>
                    <button class="option-btn" onclick="selectOption(3, '1500-2500', this)">R$1500 a R$2500</button>
                    <button class="option-btn" onclick="selectOption(3, 'sem-limite', this)">O c√©u √© o limite</button>
                </div>
                <button class="next-btn" id="next-3" onclick="startDiagnostic()">Iniciar Diagn√≥stico ‚Üí</button>
            </div>
        </div>

        <!-- DIAGNOSTIC SECTION -->
        <div id="diagnostic-section" style="display: none;">
            <h2 class="section-title">üéØ DIAGN√ìSTICO: SUA COLE√á√ÉO EST√Å EQUILIBRADA?</h2>
            
            <div class="balance-section">
                <div class="balance-card">
                    <div class="balance-title">Identifique sua fam√≠lia dominante</div>
                    <div class="balance-description">
                        Conte quantos perfumes voc√™ tem de cada fam√≠lia. A fam√≠lia com mais perfumes √© sua dominante.
                    </div>

                    <!-- GRID: Contexto Pessoal + CTA Iniciantes -->
                    <div id="grid-contexto-cta" style="
                        display: grid;
                        grid-template-columns: 1fr 1fr;
                        gap: 25px;
                        margin-bottom: 30px;
                        align-items: stretch;
                    ">
                        <!-- CONTEXTO PESSOAL -->
                        <div class="context-section">
                            <div class="context-title">üìç Contexto Pessoal</div>
                            <div class="context-grid">
                                <div class="context-item">
                                    <label for="estado">Estado onde mora:</label>
                                    <select id="estado" style="
                                        width: 100%;
                                        padding: 10px;
                                        font-size: 1em;
                                        background: rgba(0, 0, 0, 0.3);
                                        border: 2px solid rgba(100, 150, 255, 0.3);
                                        border-radius: 5px;
                                        color: white;
                                        cursor: pointer;
                                    ">
                                        <option value="">Selecione seu estado</option>
                                        <option value="AC">Acre (AC)</option>
                                        <option value="AL">Alagoas (AL)</option>
                                        <option value="AP">Amap√° (AP)</option>
                                        <option value="AM">Amazonas (AM)</option>
                                        <option value="BA">Bahia (BA)</option>
                                        <option value="CE">Cear√° (CE)</option>
                                        <option value="DF">Distrito Federal (DF)</option>
                                        <option value="ES">Esp√≠rito Santo (ES)</option>
                                        <option value="GO">Goi√°s (GO)</option>
                                        <option value="MA">Maranh√£o (MA)</option>
                                        <option value="MT">Mato Grosso (MT)</option>
                                        <option value="MS">Mato Grosso do Sul (MS)</option>
                                        <option value="MG">Minas Gerais (MG)</option>
                                        <option value="PA">Par√° (PA)</option>
                                        <option value="PB">Para√≠ba (PB)</option>
                                        <option value="PR">Paran√° (PR)</option>
                                        <option value="PE">Pernambuco (PE)</option>
                                        <option value="PI">Piau√≠ (PI)</option>
                                        <option value="RJ">Rio de Janeiro (RJ)</option>
                                        <option value="RN">Rio Grande do Norte (RN)</option>
                                        <option value="RS">Rio Grande do Sul (RS)</option>
                                        <option value="RO">Rond√¥nia (RO)</option>
                                        <option value="RR">Roraima (RR)</option>
                                        <option value="SC">Santa Catarina (SC)</option>
                                        <option value="SP">S√£o Paulo (SP)</option>
                                        <option value="SE">Sergipe (SE)</option>
                                        <option value="TO">Tocantins (TO)</option>
                                    </select>
                                </div>
                                <div class="context-item">
                                    <label for="cidade">Cidade onde mora:</label>
                                    <select id="cidade" style="
                                        width: 100%;
                                        padding: 10px;
                                        font-size: 1em;
                                        background: rgba(0, 0, 0, 0.3);
                                        border: 2px solid rgba(100, 150, 255, 0.3);
                                        border-radius: 5px;
                                        color: white;
                                        cursor: pointer;
                                    " disabled>
                                        <option value="">Selecione o estado primeiro</option>
                                    </select>
                                </div>
                                <div class="context-item">
                                    <label>Ambiente de trabalho:</label>
                                    <div class="checkbox-group">
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="amb-fechado" value="fechado">
                                            <span>Fechado (escrit√≥rio, loja)</span>
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="amb-aberto" value="aberto">
                                            <span>Aberto (obra, rua, campo)</span>
                                        </label>
                                        <label class="checkbox-label">
                                            <input type="checkbox" id="amb-ambos" value="ambos">
                                            <span>Ambos (varia)</span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- CTA PARA INICIANTES -->
                        <div style="
                            padding: 30px 25px;
                            background: linear-gradient(135deg, rgba(255, 100, 100, 0.2), rgba(255, 50, 50, 0.1));
                            border: 3px solid #ff6666;
                            border-radius: 15px;
                            text-align: center;
                            box-shadow: 0 10px 30px rgba(255, 100, 100, 0.3);
                            display: flex;
                            flex-direction: column;
                            justify-content: center;
                            height: 100%;
                        ">
                            <div style="font-size: 2em; margin-bottom: 12px;">ü§∑‚Äç‚ôÇÔ∏è</div>
                            <div style="color: #ff9999; font-size: 1.2em; font-weight: 700; margin-bottom: 12px;">
                                N√£o sabe quantos perfumes tem de cada fam√≠lia?
                            </div>
                            <div style="color: #ccc; font-size: 0.95em; margin-bottom: 20px; line-height: 1.5;">
                                Sem problema! Se voc√™ ainda n√£o domina perfumaria, temos o caminho certo para voc√™ come√ßar.
                            </div>
                            <button onclick="abrirPopupIniciante()" style="
                                width: 100%;
                                padding: 15px 25px;
                                font-size: 1.1em;
                                font-weight: 700;
                                background: linear-gradient(135deg, #ff6666 0%, #ff4444 100%);
                                border: none;
                                color: #fff;
                                border-radius: 12px;
                                cursor: pointer;
                                box-shadow: 0 8px 25px rgba(255, 100, 100, 0.4);
                                transition: all 0.3s ease;
                            " onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 12px 35px rgba(255, 100, 100, 0.6)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 8px 25px rgba(255, 100, 100, 0.4)';">
                                ‚ùå N√ÉO SEI NADA DE PERFUMES MASCULINOS!
                            </button>
                        </div>
                    </div>
                    
                    <!-- Media Query para Mobile -->
                    <style>
                        @media (max-width: 768px) {
                            #grid-contexto-cta {
                                grid-template-columns: 1fr !important;
                            }
                        }
                    </style>
                    
                    <div class="family-counter">
                        <div class="counter-item">
                            <label>üçã Fresco/C√≠trico</label>
                            <input type="number" id="fresco" min="0" max="20" value="0">
                        </div>
                        <div class="counter-item">
                            <label>üåø Arom√°tico/Verde</label>
                            <input type="number" id="aromatico" min="0" max="20" value="0">
                        </div>
                        <div class="counter-item">
                            <label>üçØ Doce/Gourmand</label>
                            <input type="number" id="doce" min="0" max="20" value="0">
                        </div>
                        <div class="counter-item">
                            <label>ü™µ Amadeirado</label>
                            <input type="number" id="amadeirado" min="0" max="20" value="0">
                        </div>
                        <div class="counter-item">
                            <label>üî• Especiado/Oriental</label>
                            <input type="number" id="especiado" min="0" max="20" value="0">
                        </div>
                        <div class="counter-item">
                            <label>üåä Aqu√°tico</label>
                            <input type="number" id="aquatico" min="0" max="20" value="0">
                        </div>
                    </div>

                    <button class="analyze-btn" onclick="analyzeCollection()">ANALISAR COLE√á√ÉO</button>

                    <div id="result" class="result-box" style="display: none;">
                        <div class="result-title">üìä RESULTADO DA AN√ÅLISE</div>
                        <div id="dominant-family" class="result-content"></div>
                        <div id="balance-advice" class="result-advice"></div>
                        <div id="next-purchase" class="result-next"></div>
                        
                        <!-- Bot√£o de I.A. que abre popup de convers√£o -->
                        <div style="margin-top: 30px; text-align: center;">
                            <div style="
                                background: linear-gradient(135deg, rgba(212, 175, 55, 0.2), rgba(212, 175, 55, 0.1));
                                border: 3px solid rgba(76, 175, 80, 0.5);
                                border-radius: 12px;
                                padding: 20px 25px;
                                margin-bottom: 20px;
                                background: linear-gradient(135deg, rgba(76, 175, 80, 0.2), rgba(76, 175, 80, 0.1));
                                text-align: center;
                            ">
                                <div style="color: #81c784; font-size: 1.3em; font-weight: 700; margin-bottom: 10px;">
                                    üõ°Ô∏è GARANTIA DE 7 DIAS
                                </div>
                                <div style="color: #fff; font-size: 1em; line-height: 1.6;">
                                    Teste o curso por 7 dias. Se n√£o gostar,<br>
                                    devolvemos 100% do seu dinheiro. Sem perguntas.
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // URL do Google Sheets
        const SHEET_URL = 'https://script.google.com/macros/s/AKfycbwVsf5BS_uSNmcGHzM8NTXlhquBXQ7qwejle6NpB7g4rUfdXnIkGrqW937ZeOXp9xQ/exec';

        // Fun√ß√£o para enviar dados ao Google Sheets
        function sendToSheet(data) {
            fetch(SHEET_URL, {
                method: 'POST',
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            }).catch(error => console.log('Dados enviados'));
        }

        // Armazenar respostas do quiz
        const quizAnswers = {
            q1: null,
            q2: null,
            q3: null
        };

        function selectOption(question, value, button) {
            // Salvar resposta
            quizAnswers[`q${question}`] = value;
            
            // Remover sele√ß√£o de todos os bot√µes da mesma pergunta
            const allButtons = button.parentElement.querySelectorAll('.option-btn');
            allButtons.forEach(btn => btn.classList.remove('selected'));
            
            // Selecionar bot√£o clicado
            button.classList.add('selected');
            
            // Habilitar bot√£o "Pr√≥xima"
            const nextBtn = document.getElementById(`next-${question}`);
            nextBtn.classList.add('enabled');
        }

        function nextQuestion(current) {
            // ENVIAR DADOS DA PERGUNTA ATUAL
            const etapa = `Pergunta ${current}`;
            const resposta = quizAnswers[`q${current}`];
            
            sendToSheet({
                etapa: etapa,
                q1: quizAnswers.q1,
                q2: quizAnswers.q2,
                q3: quizAnswers.q3,
                status: 'Em andamento'
            });
            
            // Esconder pergunta atual
            document.getElementById(`quiz-${current}`).classList.remove('active');
            
            // Mostrar pr√≥xima pergunta
            const next = current + 1;
            document.getElementById(`quiz-${next}`).classList.add('active');
            
            // Scroll para o topo
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function startDiagnostic() {
            // Salvar respostas do quiz no localStorage
            localStorage.setItem('quiz_answers', JSON.stringify(quizAnswers));
            
            // ENVIAR DADOS: Completou Quiz
            sendToSheet({
                etapa: 'Quiz Completo',
                q1: quizAnswers.q1,
                q2: quizAnswers.q2,
                q3: quizAnswers.q3,
                status: 'Iniciou Diagn√≥stico'
            });
            
            // Esconder quiz
            document.getElementById('quiz-3').style.display = 'none';
            
            // Mostrar se√ß√£o de diagn√≥stico
            document.getElementById('diagnostic-section').style.display = 'block';
            
            // Scroll para o topo
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Analisar cole√ß√£o com loading
        function analyzeCollection() {
            const families = {
                'fresco': { name: 'üçã Fresco/C√≠trico', value: parseInt(document.getElementById('fresco').value) || 0 },
                'aromatico': { name: 'üåø Arom√°tico/Verde', value: parseInt(document.getElementById('aromatico').value) || 0 },
                'doce': { name: 'üçØ Doce/Gourmand', value: parseInt(document.getElementById('doce').value) || 0 },
                'amadeirado': { name: 'ü™µ Amadeirado', value: parseInt(document.getElementById('amadeirado').value) || 0 },
                'especiado': { name: 'üî• Especiado/Oriental', value: parseInt(document.getElementById('especiado').value) || 0 },
                'aquatico': { name: 'üåä Aqu√°tico', value: parseInt(document.getElementById('aquatico').value) || 0 }
            };

            const total = Object.values(families).reduce((sum, f) => sum + f.value, 0);

            if (total === 0) {
                alert('Adicione pelo menos 1 perfume para analisar');
                return;
            }

            // MOSTRAR POPUP DE LOADING
            mostrarLoading();

            // Simular processamento por 2.5 segundos
            setTimeout(() => {
                fecharLoading();
                processarAnalise(families, total);
            }, 2500);
        }

        function mostrarLoading() {
            const overlay = document.createElement('div');
            overlay.id = 'loading-overlay';
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.9);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 9999;
                animation: fadeIn 0.3s ease;
            `;

            overlay.innerHTML = `
                <div style="
                    background: linear-gradient(135deg, #2d2d2d 0%, #1e1e1e 100%);
                    border: 3px solid #d4af37;
                    border-radius: 20px;
                    padding: 50px 60px;
                    text-align: center;
                    box-shadow: 0 20px 60px rgba(212, 175, 55, 0.5);
                    animation: slideUp 0.4s ease;
                ">
                    <div style="font-size: 4em; margin-bottom: 20px; animation: spin 1.5s linear infinite;">
                        üîÑ
                    </div>
                    <div style="color: #d4af37; font-size: 1.8em; font-weight: 700; margin-bottom: 15px;">
                        Analisando sua cole√ß√£o...
                    </div>
                    <div style="color: #ccc; font-size: 1em; margin-bottom: 25px;">
                        Processando dados e identificando padr√µes
                    </div>
                    
                    <div style="
                        width: 300px;
                        height: 8px;
                        background: rgba(212, 175, 55, 0.2);
                        border-radius: 10px;
                        overflow: hidden;
                        margin: 0 auto;
                    ">
                        <div id="progress-bar" style="
                            width: 0%;
                            height: 100%;
                            background: linear-gradient(90deg, #d4af37, #f4e5b1);
                            border-radius: 10px;
                            transition: width 0.3s ease;
                        "></div>
                    </div>
                </div>
            `;

            const style = document.createElement('style');
            style.textContent = `
                @keyframes spin {
                    from { transform: rotate(0deg); }
                    to { transform: rotate(360deg); }
                }
                @keyframes fadeIn {
                    from { opacity: 0; }
                    to { opacity: 1; }
                }
                @keyframes slideUp {
                    from { transform: translateY(30px); opacity: 0; }
                    to { transform: translateY(0); opacity: 1; }
                }
                @keyframes fadeOut {
                    from { opacity: 1; }
                    to { opacity: 0; }
                }
            `;
            document.head.appendChild(style);

            document.body.appendChild(overlay);

            let progress = 0;
            const interval = setInterval(() => {
                progress += 4;
                const bar = document.getElementById('progress-bar');
                if (bar) bar.style.width = progress + '%';
                if (progress >= 100) clearInterval(interval);
            }, 100);
        }

        function fecharLoading() {
            const overlay = document.getElementById('loading-overlay');
            if (overlay) {
                overlay.style.animation = 'fadeOut 0.3s ease';
                setTimeout(() => overlay.remove(), 300);
            }
        }

        function processarAnalise(families, total) {
            const estado = document.getElementById('estado').value;
            const cidade = document.getElementById('cidade').value;
            const ambFechado = document.getElementById('amb-fechado').checked;
            const ambAberto = document.getElementById('amb-aberto').checked;
            const ambAmbos = document.getElementById('amb-ambos').checked;

            // Determina clima baseado na cidade (se selecionada) ou estado
            let climaRegiao = 'temperado';
            
            if (cidade && estado) {
                // Usa o mapeamento de cidades
                const cidadesEstado = cidadesPorEstado[estado] || {};
                climaRegiao = cidadesEstado[cidade] || 'temperado';
            } else if (estado) {
                // Fallback: usa mapeamento de estado
                const estadosQuentes = ['AM', 'AC', 'RR', 'AP', 'PA', 'TO', 'MA', 'PI', 'CE', 'RN', 'PB', 'PE', 'AL', 'SE', 'BA', 'MT', 'MS', 'GO', 'DF', 'MG', 'ES', 'RJ', 'SP'];
                const estadosFrios = ['RS', 'SC', 'PR'];
                
                if (estadosQuentes.includes(estado)) {
                    climaRegiao = 'quente';
                } else if (estadosFrios.includes(estado)) {
                    climaRegiao = 'frio';
                }
            }

            const familiesRepresented = Object.values(families).filter(f => f.value > 0).length;

            let dominant = null;
            let maxValue = 0;
            Object.entries(families).forEach(([key, data]) => {
                if (data.value > maxValue) {
                    maxValue = data.value;
                    dominant = { key, ...data };
                }
            });

            const percentage = ((maxValue / total) * 100).toFixed(0);

            let level = '';
            let levelEmoji = '';
            let levelAdvice = '';

            if (total >= 1 && total <= 5) {
                levelEmoji = 'üéØ';
                level = 'INICIANTE';
                levelAdvice = 'Voc√™ est√° come√ßando. Foque nas 5 fun√ß√µes b√°sicas (calor, frio, trabalho, noite, assinatura) antes de diversificar.';
            } else if (total >= 6 && total <= 10) {
                if (familiesRepresented >= 4 && percentage < 50) {
                    levelEmoji = '‚ö°';
                    level = 'INTERMEDI√ÅRIO';
                    levelAdvice = 'Cole√ß√£o crescendo bem. Continue diversificando e evite redund√¢ncias na fam√≠lia dominante.';
                } else {
                    levelEmoji = '‚ö†Ô∏è';
                    level = 'INTERMEDI√ÅRIO (com desequil√≠brio)';
                    levelAdvice = 'Voc√™ tem quantidade de intermedi√°rio, mas est√° comprando muito da mesma fam√≠lia. Diversifique antes de expandir.';
                }
            } else if (total >= 11 && total <= 15) {
                if (familiesRepresented >= 5 && percentage <= 40) {
                    levelEmoji = 'üî•';
                    level = 'AVAN√áADO';
                    levelAdvice = 'Cole√ß√£o madura e equilibrada. Cada novo perfume deve preencher uma subfun√ß√£o espec√≠fica.';
                } else {
                    levelEmoji = '‚ö†Ô∏è';
                    level = 'AVAN√áADO (com redund√¢ncia)';
                    levelAdvice = 'Voc√™ tem muitos perfumes, mas com sobreposi√ß√£o. Identifique os redundantes e considere vender/trocar.';
                }
            } else {
                if (percentage <= 35 && familiesRepresented >= 5) {
                    levelEmoji = 'üëë';
                    level = 'COLECIONADOR EQUILIBRADO';
                    levelAdvice = 'Cole√ß√£o extensa e diversificada. Agora o foco √©: cada perfume tem fun√ß√£o clara?';
                } else {
                    levelEmoji = '‚ö†Ô∏è';
                    level = 'COLECIONADOR (com ac√∫mulo)';
                    levelAdvice = 'Voc√™ tem MUITOS perfumes, mas est√° acumulando redund√¢ncias. Pare de comprar e reorganize.';
                }
            }

            const missing = Object.entries(families)
                .filter(([key, data]) => data.value === 0)
                .map(([key, data]) => ({ key, ...data }));
            
            const weak = Object.entries(families)
                .filter(([key, data]) => data.value === 1)
                .map(([key, data]) => ({ key, ...data }));

            // ENVIAR DADOS: Diagn√≥stico Completo
            const ambientes = [];
            if (ambFechado) ambientes.push('Fechado');
            if (ambAberto) ambientes.push('Aberto');
            if (ambAmbos) ambientes.push('Ambos');

            const missingNames = [...missing, ...weak].map(f => f.name).join(', ');

            sendToSheet({
                etapa: 'Diagn√≥stico Completo',
                q1: quizAnswers.q1,
                q2: quizAnswers.q2,
                q3: quizAnswers.q3,
                estado: estado,
                cidade: cidade,
                ambiente: ambientes.join(', '),
                totalPerfumes: total,
                familiaDominante: dominant.name,
                percentagemDominante: percentage + '%',
                familiasFaltando: missingNames || 'Nenhuma',
                nivel: level,
                status: 'Viu Resultado'
            });

            const resultDiv = document.getElementById('result');
            const dominantDiv = document.getElementById('dominant-family');
            const adviceDiv = document.getElementById('balance-advice');
            const nextDiv = document.getElementById('next-purchase');

            // Mapeamento de nomes completos dos estados (escopo global da fun√ß√£o)
            const estadosNomes = {
                'AC': 'Acre', 'AL': 'Alagoas', 'AP': 'Amap√°', 'AM': 'Amazonas',
                'BA': 'Bahia', 'CE': 'Cear√°', 'DF': 'Distrito Federal', 'ES': 'Esp√≠rito Santo',
                'GO': 'Goi√°s', 'MA': 'Maranh√£o', 'MT': 'Mato Grosso', 'MS': 'Mato Grosso do Sul',
                'MG': 'Minas Gerais', 'PA': 'Par√°', 'PB': 'Para√≠ba', 'PR': 'Paran√°',
                'PE': 'Pernambuco', 'PI': 'Piau√≠', 'RJ': 'Rio de Janeiro', 'RN': 'Rio Grande do Norte',
                'RS': 'Rio Grande do Sul', 'RO': 'Rond√¥nia', 'RR': 'Roraima',
                'SC': 'Santa Catarina', 'SP': 'S√£o Paulo', 'SE': 'Sergipe', 'TO': 'Tocantins'
            };

            let contextoHTML = '';
            if (estado || cidade) {
                const estadoNome = estadosNomes[estado] || estado;
                let climaEmoji = climaRegiao === 'quente' ? 'üå°Ô∏è' : climaRegiao === 'frio' ? '‚ùÑÔ∏è' : 'üå§Ô∏è';
                
                // Exibe cidade + estado (se cidade selecionada) ou s√≥ estado
                const localizacao = cidade ? `${cidade}, ${estadoNome}` : estadoNome;
                contextoHTML += `<strong>Sua regi√£o:</strong> ${localizacao} ${climaEmoji} (clima ${climaRegiao})<br>`;
            }
            if (ambFechado || ambAberto || ambAmbos) {
                let ambientes = [];
                if (ambFechado) ambientes.push('Fechado');
                if (ambAberto) ambientes.push('Aberto');
                if (ambAmbos) ambientes.push('Ambos');
                contextoHTML += `<strong>Ambiente de trabalho:</strong> ${ambientes.join(', ')}<br>`;
            }

            // Criar layout gr√°fico compacto para as informa√ß√µes
            const infoCards = `
                <div style="
                    display: grid;
                    grid-template-columns: repeat(2, 1fr);
                    gap: 12px;
                    margin-bottom: 20px;
                ">
                    ${contextoHTML ? `
                        <div style="
                            background: linear-gradient(135deg, rgba(100, 150, 255, 0.15), rgba(100, 150, 255, 0.05));
                            border: 2px solid rgba(100, 150, 255, 0.4);
                            border-radius: 8px;
                            padding: 12px;
                        ">
                            <div style="font-size: 0.85em; color: #9bc4ff; margin-bottom: 6px; font-weight: 600;">üìç LOCALIZA√á√ÉO</div>
                            <div style="color: #fff; font-size: 0.95em; line-height: 1.5;">
                                ${estado && cidade ? `${cidade}, ${estadosNomes[estado] || estado}` : (estado ? estadosNomes[estado] || estado : 'N√£o informado')}<br>
                                ${estado || cidade ? `<span style="color: #9bc4ff;">${climaRegiao === 'quente' ? 'üå°Ô∏è Clima quente' : climaRegiao === 'frio' ? '‚ùÑÔ∏è Clima frio' : 'üå§Ô∏è Clima temperado'}</span>` : ''}
                            </div>
                        </div>
                    ` : ''}
                    
                    ${ambFechado || ambAberto || ambAmbos ? `
                        <div style="
                            background: linear-gradient(135deg, rgba(100, 150, 255, 0.15), rgba(100, 150, 255, 0.05));
                            border: 2px solid rgba(100, 150, 255, 0.4);
                            border-radius: 8px;
                            padding: 12px;
                        ">
                            <div style="font-size: 0.85em; color: #9bc4ff; margin-bottom: 6px; font-weight: 600;">üíº AMBIENTE</div>
                            <div style="color: #fff; font-size: 0.95em;">
                                ${[ambFechado && 'Fechado', ambAberto && 'Aberto', ambAmbos && 'Ambos'].filter(Boolean).join(', ')}
                            </div>
                        </div>
                    ` : ''}
                    
                    <div style="
                        background: linear-gradient(135deg, rgba(212, 175, 55, 0.15), rgba(212, 175, 55, 0.05));
                        border: 2px solid rgba(212, 175, 55, 0.4);
                        border-radius: 8px;
                        padding: 12px;
                    ">
                        <div style="font-size: 0.85em; color: #d4af37; margin-bottom: 6px; font-weight: 600;">üìä TOTAL</div>
                        <div style="color: #fff; font-size: 1.3em; font-weight: 700;">${total} perfumes</div>
                    </div>
                    
                    <div style="
                        background: linear-gradient(135deg, rgba(212, 175, 55, 0.15), rgba(212, 175, 55, 0.05));
                        border: 2px solid rgba(212, 175, 55, 0.4);
                        border-radius: 8px;
                        padding: 12px;
                    ">
                        <div style="font-size: 0.85em; color: #d4af37; margin-bottom: 6px; font-weight: 600;">üéØ FAM√çLIAS</div>
                        <div style="color: #fff; font-size: 1.3em; font-weight: 700;">${familiesRepresented}/6</div>
                    </div>
                    
                    <div style="
                        background: linear-gradient(135deg, rgba(212, 175, 55, 0.2), rgba(212, 175, 55, 0.1));
                        border: 3px solid #d4af37;
                        border-radius: 8px;
                        padding: 12px;
                        grid-column: 1 / -1;
                    ">
                        <div style="font-size: 0.85em; color: #d4af37; margin-bottom: 8px; font-weight: 600;">üëë FAM√çLIA DOMINANTE</div>
                        <div style="color: #fff; font-size: 1.2em; font-weight: 700; margin-bottom: 4px;">
                            ${dominant.name}
                        </div>
                        <div style="color: #f4e5b1; font-size: 1em;">
                            ${maxValue} perfumes ¬∑ <strong style="color: #d4af37; font-size: 1.15em;">${percentage}%</strong> da cole√ß√£o
                        </div>
                    </div>
                </div>
                
                <style>
                    @media (max-width: 768px) {
                        #dominant-family > div:first-child {
                            grid-template-columns: 1fr !important;
                        }
                    }
                </style>
            `;

            dominantDiv.innerHTML = `
                <div style="background: rgba(212, 175, 55, 0.15); padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #d4af37;">
                    <div style="font-size: 1.3em; margin-bottom: 10px;">${levelEmoji} <strong>SEU N√çVEL: ${level}</strong></div>
                    <div style="color: #ccc; font-size: 0.95em;">${levelAdvice}</div>
                </div>
                ${infoCards}
            `;

            let advice = '';
            let status = '';

            if (percentage >= 50) {
                status = `
                    <div style="text-align: center; margin-bottom: 15px;">
                        <div style="
                            display: inline-block;
                            background: linear-gradient(135deg, rgba(212, 175, 55, 0.2), rgba(212, 175, 55, 0.1));
                            border: 2px solid #d4af37;
                            border-radius: 8px;
                            padding: 10px 30px;
                        ">
                            <span style="color: #d4af37; font-size: 1.3em; font-weight: 700; letter-spacing: 2px;">
                                üìã DIAGN√ìSTICO
                            </span>
                        </div>
                    </div>
                    <div style="
                        background: linear-gradient(135deg, rgba(255, 50, 50, 0.3), rgba(200, 0, 0, 0.2));
                        border: 4px solid #ff3333;
                        border-radius: 12px;
                        padding: 25px;
                        margin-bottom: 20px;
                        box-shadow: 0 0 30px rgba(255, 50, 50, 0.5);
                        animation: pulse-red 2s infinite;
                    ">
                        <div style="font-size: 2em; text-align: center; margin-bottom: 10px;">üö®</div>
                        <div style="font-size: 1.5em; font-weight: 700; color: #ff6666; text-align: center; text-transform: uppercase;">
                            ATEN√á√ÉO: COLE√á√ÉO DESBALANCEADA!
                        </div>
                    </div>
                    <style>
                        @keyframes pulse-red {
                            0%, 100% { box-shadow: 0 0 30px rgba(255, 50, 50, 0.5); }
                            50% { box-shadow: 0 0 50px rgba(255, 50, 50, 0.8); }
                        }
                    </style>
                `;
                advice = `
                    <div style="font-size: 1.25em; line-height: 1.8; margin-top: 15px;">
                        <div style="text-align: center;">
                            <strong style="color: #ff6666; font-size: 1.4em;">VOC√ä EST√Å DESPERDI√áANDO DINHEIRO!</strong>
                        </div>
                        <br>
                        <span style="font-size: 1.15em; color: #fff;">
                            Voc√™ est√° viciado em <strong style="color: #d4af37;">${dominant.name}</strong>. 
                            Isso cria <strong style="color: #ff6666;">redund√¢ncia cr√≠tica</strong> ‚Äî voc√™ tem v√°rios perfumes fazendo a MESMA fun√ß√£o.
                        </span>
                        <br><br>
                        <strong style="color: #ffaa00; font-size: 1.15em;">üí∏ Resultado:</strong> 
                        <span style="font-size: 1.1em;">
                            Voc√™ gasta mais, usa menos, e n√£o tem op√ß√µes reais para diferentes situa√ß√µes.
                        </span>
                    </div>
                `;
            } else if (percentage >= 35) {
                status = `
                    <div style="text-align: center; margin-bottom: 15px;">
                        <div style="
                            display: inline-block;
                            background: linear-gradient(135deg, rgba(212, 175, 55, 0.2), rgba(212, 175, 55, 0.1));
                            border: 2px solid #d4af37;
                            border-radius: 8px;
                            padding: 10px 30px;
                        ">
                            <span style="color: #d4af37; font-size: 1.3em; font-weight: 700; letter-spacing: 2px;">
                                üìã DIAGN√ìSTICO
                            </span>
                        </div>
                    </div>
                    <div style="
                        background: linear-gradient(135deg, rgba(255, 165, 0, 0.3), rgba(255, 140, 0, 0.2));
                        border: 4px solid #ff9933;
                        border-radius: 12px;
                        padding: 25px;
                        margin-bottom: 20px;
                        box-shadow: 0 0 30px rgba(255, 165, 0, 0.5);
                        animation: pulse-orange 2.5s infinite;
                    ">
                        <div style="font-size: 2em; text-align: center; margin-bottom: 10px;">‚ö†Ô∏è</div>
                        <div style="font-size: 1.4em; font-weight: 700; color: #ffaa00; text-align: center; text-transform: uppercase;">
                            Alerta: Cole√ß√£o com Vi√©s!
                        </div>
                    </div>
                    <style>
                        @keyframes pulse-orange {
                            0%, 100% { box-shadow: 0 0 30px rgba(255, 165, 0, 0.5); }
                            50% { box-shadow: 0 0 45px rgba(255, 165, 0, 0.7); }
                        }
                    </style>
                `;
                advice = `
                    <div style="font-size: 1.25em; line-height: 1.8; margin-top: 15px;">
                        <div style="text-align: center;">
                            <strong style="color: #ffaa00; font-size: 1.3em;">SUA COLE√á√ÉO EST√Å DESEQUILIBRADA!</strong>
                        </div>
                        <br>
                        <span style="font-size: 1.15em; color: #fff;">
                            <strong style="color: #d4af37;">${dominant.name}</strong> domina sua cole√ß√£o (<strong style="color: #ffaa00; font-size: 1.2em;">${percentage}%</strong>). 
                            Voc√™ est√° comprando sempre o mesmo tipo de perfume.
                        </span>
                        <br><br>
                        <strong style="color: #ffcc66; font-size: 1.15em;">‚ö†Ô∏è Aten√ß√£o:</strong> 
                        <span style="font-size: 1.1em;">
                            Seu pr√≥ximo perfume <strong style="color: #ff6666;">N√ÉO</strong> deve ser dessa fam√≠lia. 
                            Voc√™ precisa diversificar <strong style="color: #ffaa00;">AGORA!</strong>
                        </span>
                    </div>
                `;
            } else {
                status = `
                    <div style="text-align: center; margin-bottom: 15px;">
                        <div style="
                            display: inline-block;
                            background: linear-gradient(135deg, rgba(212, 175, 55, 0.2), rgba(212, 175, 55, 0.1));
                            border: 2px solid #d4af37;
                            border-radius: 8px;
                            padding: 10px 30px;
                        ">
                            <span style="color: #d4af37; font-size: 1.3em; font-weight: 700; letter-spacing: 2px;">
                                üìã DIAGN√ìSTICO
                            </span>
                        </div>
                    </div>
                    <div style="
                        background: linear-gradient(135deg, rgba(76, 175, 80, 0.2), rgba(76, 175, 80, 0.1));
                        border: 3px solid rgba(76, 175, 80, 0.5);
                        border-radius: 12px;
                        padding: 20px;
                        margin-bottom: 20px;
                        text-align: center;
                    ">
                        <div style="font-size: 1.8em; margin-bottom: 8px;">‚úÖ</div>
                        <div style="font-size: 1.3em; font-weight: 700; color: #81c784;">
                            COLE√á√ÉO EQUILIBRADA
                        </div>
                    </div>
                `;
                advice = `Sua cole√ß√£o tem boa distribui√ß√£o entre fam√≠lias. Voc√™ tem op√ß√µes reais para diferentes contextos.`;
            }

            // Adicionar fam√≠lias faltando ao advice
            if (missingNames) {
                advice += `
                    <div style="
                        margin-top: 25px;
                        padding: 20px;
                        background: rgba(212, 175, 55, 0.15);
                        border-left: 5px solid #d4af37;
                        border-radius: 8px;
                    ">
                        <strong style="color: #d4af37; font-size: 1.3em;">
                            üéØ Fam√≠lias que voc√™ precisa adicionar:
                        </strong>
                        <br><br>
                        <span style="font-size: 1.2em; color: #f4e5b1; line-height: 1.8;">
                            üìç ${missingNames}
                        </span>
                    </div>
                `;
            }

            adviceDiv.innerHTML = status + advice;

            // Grid lado a lado: Sugest√µes Borradas + Info do Curso
            let nextPurchase = `
                <div style="
                    display: grid;
                    grid-template-columns: 1fr 1fr;
                    gap: 25px;
                    margin-top: 30px;
                ">
                    <!-- COLUNA 1: SUGEST√ïES BORRADAS -->
                    <div class="coluna-hover" style="
                        background: linear-gradient(135deg, rgba(212, 175, 55, 0.15), rgba(212, 175, 55, 0.05));
                        border: 3px solid #d4af37;
                        border-radius: 15px;
                        padding: 25px;
                        box-shadow: 0 10px 40px rgba(212, 175, 55, 0.3);
                        display: flex;
                        flex-direction: column;
                        transition: all 0.3s ease;
                        user-select: none;
                        -webkit-user-select: none;
                        -moz-user-select: none;
                        -ms-user-select: none;
                        pointer-events: none;
                    ">
                        <div style="
                            color: #d4af37;
                            font-size: 1.3em;
                            font-weight: 700;
                            margin-bottom: 20px;
                            text-align: center;
                        ">
                            üéØ SUGEST√ïES PERSONALIZADAS
                        </div>
                        
                        <!-- SUGEST√ÉO 1 -->
                        <div style="
                            background: rgba(212, 175, 55, 0.1);
                            border: 2px solid rgba(212, 175, 55, 0.3);
                            border-radius: 12px;
                            padding: 18px;
                            margin-bottom: 12px;
                            filter: blur(2px);
                            opacity: 0.6;
                        ">
                            <div style="font-size: 1.1em; font-weight: 700; color: #d4af37; margin-bottom: 8px;">
                                üìç PRIORIDADE 1
                            </div>
                            <div style="color: #fff; margin-bottom: 6px;">
                                <strong>Dior Sauvage EDT</strong>
                            </div>
                            <div style="color: #ccc; font-size: 0.9em; line-height: 1.5;">
                                üåø Arom√°tico/Verde<br>
                                üí∞ R$ 450-600<br>
                                üìå Trabalho, versatilidade
                            </div>
                        </div>
                        
                        <!-- SUGEST√ÉO 2 -->
                        <div style="
                            background: rgba(212, 175, 55, 0.1);
                            border: 2px solid rgba(212, 175, 55, 0.3);
                            border-radius: 12px;
                            padding: 18px;
                            margin-bottom: 12px;
                            filter: blur(4px);
                            opacity: 0.4;
                        ">
                            <div style="font-size: 1.1em; font-weight: 700; color: #d4af37; margin-bottom: 8px;">
                                üìç PRIORIDADE 2
                            </div>
                            <div style="color: #fff; margin-bottom: 6px;">
                                <strong>Acqua di Gio Profumo</strong>
                            </div>
                            <div style="color: #ccc; font-size: 0.9em; line-height: 1.5;">
                                üåä Aqu√°tico<br>
                                üí∞ R$ 400-550<br>
                                üìå Calor, casual
                            </div>
                        </div>
                        
                        <!-- SUGEST√ÉO 3 -->
                        <div style="
                            background: rgba(212, 175, 55, 0.1);
                            border: 2px solid rgba(212, 175, 55, 0.3);
                            border-radius: 12px;
                            padding: 18px;
                            margin-bottom: 15px;
                            filter: blur(5px);
                            opacity: 0.3;
                        ">
                            <div style="font-size: 1.1em; font-weight: 700; color: #d4af37; margin-bottom: 8px;">
                                üìç PRIORIDADE 3
                            </div>
                            <div style="color: #fff; margin-bottom: 6px;">
                                <strong>Spicebomb Extreme</strong>
                            </div>
                            <div style="color: #ccc; font-size: 0.9em; line-height: 1.5;">
                                üî• Especiado/Oriental<br>
                                üí∞ R$ 500-700<br>
                                üìå Noite, frio, especial
                            </div>
                        </div>
                        
                        <div style="flex-grow: 1;"></div>
                        
                        <a href="https://pay.hotmart.com/H102542620H?checkoutMode=10" target="_blank" style="text-decoration: none; margin-top: 15px; pointer-events: auto;">
                            <button style="
                                width: 100%;
                                text-align: center;
                                font-size: 1.05em;
                                font-weight: 700;
                                padding: 16px;
                                background: linear-gradient(135deg, #d4af37 0%, #f4e5b1 100%);
                                border: none;
                                border-radius: 12px;
                                cursor: pointer;
                                box-shadow: 0 8px 25px rgba(212, 175, 55, 0.5);
                                transition: all 0.3s ease;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                gap: 8px;
                            " onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 12px 35px rgba(212, 175, 55, 0.7)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 8px 25px rgba(212, 175, 55, 0.5)';">
                                <span style="color: #1e1e1e; font-size: 1.2em;">üîì</span>
                                <span style="color: #1e1e1e;">DESBLOQUEAR AGORA</span>
                            </button>
                        </a>
                    </div>
                    
                    <!-- COLUNA 2: INFO DO CURSO -->
                    <div class="coluna-hover" style="
                        background: linear-gradient(135deg, rgba(212, 175, 55, 0.15), rgba(212, 175, 55, 0.05));
                        border: 3px solid #d4af37;
                        border-radius: 15px;
                        padding: 25px;
                        box-shadow: 0 10px 40px rgba(212, 175, 55, 0.3);
                        display: flex;
                        flex-direction: column;
                        transition: all 0.3s ease;
                    ">
                        <div style="
                            text-align: center;
                            font-size: 1.5em;
                            font-weight: 700;
                            color: #d4af37;
                            margin-bottom: 18px;
                            line-height: 1.2;
                        ">
                            üìö QUER DOMINAR A PERFUMARIA MASCULINA?
                        </div>
                        
                        <div style="
                            color: #f4e5b1;
                            font-size: 1em;
                            line-height: 1.6;
                            margin-bottom: 20px;
                            text-align: center;
                        ">
                            Voc√™ agora j√° sabe suas lacunas. Para entender a <strong style="color: #fff;">Perfumaria Masculina</strong> e nunca mais errar, voc√™ <strong style="color: #d4af37;">precisa do Guia!</strong>
                        </div>
                        
                        <div style="
                            background: rgba(0, 0, 0, 0.3);
                            padding: 18px;
                            border-radius: 10px;
                            margin-bottom: 18px;
                        ">
                            <div style="
                                color: #d4af37;
                                font-size: 1.1em;
                                font-weight: 700;
                                margin-bottom: 12px;
                            ">
                                üì¶ O que voc√™ vai receber:
                            </div>
                            
                            <div style="color: #fff; font-size: 0.92em; line-height: 1.6;">
                                ü§ñ <strong>O Perfumista</strong> - Agente de I.A. 24 horas ao seu lado para te mostrar a sugest√£o perfeita.<br><br>
                                üìö <strong>Fam√≠lias Olfativas</strong> - Entenda os tipos e quando usar cada uma. Pare de afastar pessoas e comece a conquist√°-las!<br><br>
                                ‚úÖ <strong>Boas Pr√°ticas</strong> - Como aplicar e armazenar. Voc√™ n√£o quer ganhar a m√°-fama de exagerado, n√£o √©?
                            </div>
                        </div>
                        
                        <div style="flex-grow: 1;"></div>
                        
                        <a href="https://pay.hotmart.com/H102542620H?checkoutMode=10" target="_blank" style="text-decoration: none; margin-top: 15px;">
                            <button style="
                                width: 100%;
                                text-align: center;
                                font-size: 1.1em;
                                font-weight: 700;
                                padding: 16px;
                                background: linear-gradient(135deg, #d4af37 0%, #f4e5b1 100%);
                                border: none;
                                border-radius: 12px;
                                cursor: pointer;
                                box-shadow: 0 8px 25px rgba(212, 175, 55, 0.5);
                                transition: all 0.3s ease;
                                display: flex;
                                align-items: center;
                                justify-content: center;
                                gap: 8px;
                            " onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 12px 35px rgba(212, 175, 55, 0.7)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 8px 25px rgba(212, 175, 55, 0.5)';">
                                <span style="color: #1e1e1e; font-size: 1.2em;">üöÄ</span>
                                <span style="color: #1e1e1e;">QUERO APRENDER AGORA!</span>
                            </button>
                        </a>
                    </div>
                </div>
                
                <style>
                    .coluna-hover:hover {
                        transform: translateY(-8px);
                        box-shadow: 0 15px 50px rgba(212, 175, 55, 0.5) !important;
                        border-color: #f4e5b1 !important;
                    }
                    
                    @media (max-width: 968px) {
                        #next-purchase > div {
                            grid-template-columns: 1fr !important;
                        }
                    }
                </style>
            `;

            nextDiv.innerHTML = nextPurchase;

            resultDiv.style.display = 'block';
            resultDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Popup para quem n√£o sabe nada de perfumes
        function abrirPopupIniciante() {
            // MOSTRAR LOADING
            mostrarLoadingIniciante();

            // Ap√≥s 2 segundos, fecha loading e abre popup
            setTimeout(() => {
                fecharLoading();
                mostrarPopupIniciante();
            }, 2000);
        }

        function mostrarLoadingIniciante() {
            const overlay = document.createElement('div');
            overlay.id = 'loading-overlay';
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.9);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 9999;
                animation: fadeIn 0.3s ease;
            `;

            overlay.innerHTML = `
                <div style="
                    background: linear-gradient(135deg, #2d2d2d 0%, #1e1e1e 100%);
                    border: 3px solid #d4af37;
                    border-radius: 20px;
                    padding: 50px 60px;
                    text-align: center;
                    box-shadow: 0 20px 60px rgba(212, 175, 55, 0.5);
                    animation: slideUp 0.4s ease;
                ">
                    <div style="font-size: 4em; margin-bottom: 20px; animation: spin 1.5s linear infinite;">
                        ü§î
                    </div>
                    <div style="color: #d4af37; font-size: 1.8em; font-weight: 700; margin-bottom: 15px;">
                        Computando resposta...
                    </div>
                    <div style="color: #ccc; font-size: 1em; margin-bottom: 25px;">
                        Identificando a melhor solu√ß√£o para voc√™
                    </div>
                    
                    <div style="
                        width: 300px;
                        height: 8px;
                        background: rgba(212, 175, 55, 0.2);
                        border-radius: 10px;
                        overflow: hidden;
                        margin: 0 auto;
                    ">
                        <div id="progress-bar-iniciante" style="
                            width: 0%;
                            height: 100%;
                            background: linear-gradient(90deg, #d4af37, #f4e5b1);
                            border-radius: 10px;
                            transition: width 0.3s ease;
                        "></div>
                    </div>
                </div>
            `;

            document.body.appendChild(overlay);

            let progress = 0;
            const interval = setInterval(() => {
                progress += 5;
                const bar = document.getElementById('progress-bar-iniciante');
                if (bar) bar.style.width = progress + '%';
                if (progress >= 100) clearInterval(interval);
            }, 100);
        }

        function mostrarPopupIniciante() {
            const overlay = document.createElement('div');
            overlay.id = 'popup-iniciante';
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.9);
                display: flex;
                align-items: flex-start;
                justify-content: center;
                z-index: 9999;
                animation: fadeIn 0.3s ease;
                overflow-y: auto;
                padding: 80px 20px 20px 20px;
            `;

            overlay.innerHTML = `
                <div style="
                    background: linear-gradient(135deg, #2d2d2d 0%, #1e1e1e 100%);
                    border: 3px solid #d4af37;
                    border-radius: 20px;
                    padding: 50px;
                    max-width: 700px;
                    box-shadow: 0 20px 60px rgba(212, 175, 55, 0.5);
                    animation: slideUp 0.4s ease;
                ">
                    <div style="font-size: 3em; text-align: center; margin-bottom: 10px;">üìö</div>
                    
                    <div style="color: #d4af37; font-size: 2em; font-weight: 700; text-align: center; margin-bottom: 30px; line-height: 1.15;">
                        RESULTADO DA AN√ÅLISE:<br>
                        Voc√™ precisa aprender Perfumaria Masculina!
                    </div>
                    
                    <div style="
                        color: #f4e5b1;
                        font-size: 1.2em;
                        line-height: 1.8;
                        margin-bottom: 35px;
                        text-align: center;
                        padding: 20px;
                        background: rgba(212, 175, 55, 0.1);
                        border-radius: 10px;
                    ">
                        Voc√™ ainda n√£o sabe, mas est√° <strong style="color: #fff;">perdendo a chance de ser memor√°vel</strong>, de se sentir e estar bem. Com a Perfumaria, voc√™ deixa de ser mais um e passa a ser <strong style="color: #d4af37;">inesquec√≠vel</strong>.
                    </div>
                    
                    <div style="
                        color: #fff;
                        font-size: 1.15em;
                        line-height: 1.8;
                        margin-bottom: 35px;
                        text-align: center;
                        padding: 25px;
                        background: linear-gradient(135deg, rgba(212, 175, 55, 0.15), rgba(212, 175, 55, 0.05));
                        border-left: 4px solid #d4af37;
                        border-radius: 10px;
                    ">
                        Descubra como <strong style="color: #d4af37;">homens como voc√™</strong> v√™m sendo <strong style="color: #f4e5b1;">notados, admirados e respeitados</strong> apenas porque passaram a entender como usar perfumes ao seu favor, <strong style="color: #fff;">na hora e na ocasi√£o certa</strong>.
                    </div>
                    
                    <div style="
                        background: rgba(0, 0, 0, 0.3);
                        padding: 30px;
                        border-radius: 12px;
                        margin-bottom: 30px;
                    ">
                        <div style="color: #d4af37; font-size: 1.4em; font-weight: 700; margin-bottom: 20px; text-align: center; line-height: 1.3;">
                            üì¶ O que voc√™ vai receber no Guia de Perfumaria Masculina:
                        </div>
                        
                        <div style="color: #fff; font-size: 1.05em; line-height: 1.8;">
                            ü§ñ <strong>O Perfumista</strong> - Agente de I.A. 24 horas ao seu lado para te mostrar a sugest√£o perfeita para cada ocasi√£o.<br><br>
                            üìö <strong>Fam√≠lias Olfativas</strong> - Entenda os tipos, caracter√≠sticas e quando e onde usar cada uma. Aqui voc√™ vai parar de afastar as pessoas e vai come√ßar a conquist√°-las sem soltar uma palavra!<br><br>
                            ‚úÖ <strong>Boas Pr√°ticas</strong> - Como aplicar e armazenar corretamente. N√£o adianta conhecer perfumes. Tem que saber como usar e como guardar. Voc√™ n√£o quer exagerar e ganhar a m√°-fama de exagerado, n√£o √©?
                        </div>
                    </div>
                    
                    <div style="
                        background: linear-gradient(135deg, rgba(76, 175, 80, 0.2), rgba(76, 175, 80, 0.1));
                        border: 2px solid rgba(76, 175, 80, 0.5);
                        padding: 20px;
                        border-radius: 10px;
                        text-align: center;
                        margin-bottom: 30px;
                    ">
                        <div style="color: #81c784; font-size: 1.3em; font-weight: 700; margin-bottom: 10px;">
                            üõ°Ô∏è GARANTIA DE 7 DIAS
                        </div>
                        <div style="color: #fff; font-size: 1em; line-height: 1.6;">
                            Teste o curso por 7 dias. Se n√£o gostar,<br>
                            devolvemos 100% do seu dinheiro. Sem perguntas.
                        </div>
                    </div>
                    
                    <a href="https://pay.hotmart.com/H102542620H?checkoutMode=10" target="_blank" style="text-decoration: none;">
                        <button style="
                            width: 100%;
                            background: linear-gradient(135deg, #d4af37 0%, #f4e5b1 100%);
                            color: #1e1e1e;
                            border: none;
                            padding: 20px 50px;
                            border-radius: 12px;
                            font-size: 1.4em;
                            font-weight: 700;
                            cursor: pointer;
                            box-shadow: 0 10px 30px rgba(212, 175, 55, 0.5);
                            transition: all 0.3s ease;
                            margin-bottom: 20px;
                        " onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 15px 40px rgba(212, 175, 55, 0.7)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 10px 30px rgba(212, 175, 55, 0.5)';">
                            üöÄ QUERO O GUIA AGORA!
                        </button>
                    </a>
                    
                    <div style="color: #888; font-size: 0.9em; cursor: pointer; margin-top: 15px; text-align: center;" onclick="fecharPopupIniciante()">
                        Fechar (ou pressione ESC)
                    </div>
                </div>
            `;

            document.body.appendChild(overlay);

            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') fecharPopupIniciante();
            });
        }

        function fecharPopupIniciante() {
            const popup = document.getElementById('popup-iniciante');
            if (popup) popup.remove();
        }

        // Popup de convers√£o
        function abrirPopupConversao() {
            // ENVIAR DADOS: Clicou no bot√£o de I.A.
            sendToSheet({
                etapa: 'Clicou I.A.',
                q1: quizAnswers.q1,
                q2: quizAnswers.q2,
                q3: quizAnswers.q3,
                clicouIA: 'Sim',
                status: 'Interesse em Compra'
            });

            const overlay = document.createElement('div');
            overlay.id = 'popup-conversao';
            overlay.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.9);
                display: flex;
                align-items: center;
                justify-content: center;
                z-index: 9999;
                animation: fadeIn 0.3s ease;
            `;

            overlay.innerHTML = `
                <div style="
                    background: linear-gradient(135deg, #2d2d2d 0%, #1e1e1e 100%);
                    border: 3px solid #d4af37;
                    border-radius: 20px;
                    padding: 50px;
                    max-width: 600px;
                    box-shadow: 0 20px 60px rgba(212, 175, 55, 0.5);
                    animation: slideUp 0.4s ease;
                    text-align: center;
                ">
                    <div style="font-size: 4em; margin-bottom: 20px;">üîì</div>
                    <div style="color: #d4af37; font-size: 2em; font-weight: 700; margin-bottom: 20px;">
                        An√°lise Completa Bloqueada
                    </div>
                    <div style="color: #ccc; font-size: 1.1em; line-height: 1.8; margin-bottom: 30px;">
                        A an√°lise completa com:<br><br>
                        ‚úÖ <strong style="color: white;">Recomenda√ß√µes personalizadas</strong> de perfumes<br>
                        ‚úÖ <strong style="color: white;">Consultoria com I.A.</strong> especializada<br>
                        ‚úÖ <strong style="color: white;">Plano de a√ß√£o completo</strong> para sua cole√ß√£o<br><br>
                        Est√° dispon√≠vel apenas para alunos do<br>
                        <strong style="color: #d4af37; font-size: 1.2em;">Guia de Perfumes Masculinos</strong>
                    </div>
                    
                    <a href="https://pay.hotmart.com/H102542620H?checkoutMode=10" target="_blank" style="text-decoration: none;">
                        <button style="
                            background: linear-gradient(135deg, #d4af37 0%, #f4e5b1 100%);
                            color: #1e1e1e;
                            border: none;
                            padding: 20px 50px;
                            border-radius: 12px;
                            font-size: 1.3em;
                            font-weight: 700;
                            cursor: pointer;
                            box-shadow: 0 10px 30px rgba(212, 175, 55, 0.5);
                            transition: all 0.3s ease;
                            margin-bottom: 20px;
                        " onmouseover="this.style.transform='translateY(-5px)'; this.style.boxShadow='0 15px 40px rgba(212, 175, 55, 0.7)';" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 10px 30px rgba(212, 175, 55, 0.5)';">
                            üöÄ ACESSAR O CURSO COMPLETO
                        </button>
                    </a>
                    
                    <div style="color: #888; font-size: 0.9em; cursor: pointer; margin-top: 15px;" onclick="fecharPopup()">
                        Fechar (ou pressione ESC)
                    </div>
                </div>
            `;

            document.body.appendChild(overlay);

            document.addEventListener('keydown', function(e) {
                if (e.key === 'Escape') fecharPopup();
            });
        }

        function fecharPopup() {
            const popup = document.getElementById('popup-conversao');
            if (popup) popup.remove();
        }

        // Salvar contadores
        ['fresco', 'aromatico', 'doce', 'amadeirado', 'especiado', 'aquatico'].forEach(id => {
            const input = document.getElementById(id);
            if (input) {
                input.addEventListener('change', function() {
                    localStorage.setItem(`count_${id}`, this.value);
                });
                
                const saved = localStorage.getItem(`count_${id}`);
                if (saved) {
                    input.value = saved;
                }
            }
        });

        // Mapeamento de cidades por estado com clima
        const cidadesPorEstado = {
            'SP': {
                'S√£o Paulo': 'quente',
                'Campinas': 'quente',
                'Santos': 'quente',
                'Ribeir√£o Preto': 'quente',
                'Sorocaba': 'quente'
            },
            'RJ': {
                'Rio de Janeiro': 'quente',
                'Niter√≥i': 'quente',
                'Petr√≥polis': 'temperado',
                'Cabo Frio': 'quente'
            },
            'MG': {
                'Belo Horizonte': 'temperado',
                'Uberl√¢ndia': 'quente',
                'Juiz de Fora': 'temperado',
                'Contagem': 'temperado'
            },
            'RS': {
                'Porto Alegre': 'frio',
                'Caxias do Sul': 'frio',
                'Pelotas': 'frio',
                'Canoas': 'frio',
                'Gramado': 'frio'
            },
            'SC': {
                'Florian√≥polis': 'frio',
                'Joinville': 'frio',
                'Blumenau': 'frio',
                'Chapec√≥': 'frio'
            },
            'PR': {
                'Curitiba': 'frio',
                'Londrina': 'temperado',
                'Maring√°': 'temperado',
                'Ponta Grossa': 'frio'
            },
            'BA': {
                'Salvador': 'quente',
                'Feira de Santana': 'quente',
                'Vit√≥ria da Conquista': 'quente',
                'Ilh√©us': 'quente'
            },
            'CE': {
                'Fortaleza': 'quente',
                'Juazeiro do Norte': 'quente',
                'Sobral': 'quente'
            },
            'PE': {
                'Recife': 'quente',
                'Jaboat√£o dos Guararapes': 'quente',
                'Olinda': 'quente',
                'Caruaru': 'quente'
            },
            'AM': {
                'Manaus': 'quente',
                'Parintins': 'quente',
                'Itacoatiara': 'quente'
            },
            'PA': {
                'Bel√©m': 'quente',
                'Ananindeua': 'quente',
                'Santar√©m': 'quente'
            },
            'GO': {
                'Goi√¢nia': 'quente',
                'Aparecida de Goi√¢nia': 'quente',
                'An√°polis': 'quente'
            },
            'DF': {
                'Bras√≠lia': 'quente'
            },
            'ES': {
                'Vit√≥ria': 'quente',
                'Vila Velha': 'quente',
                'Serra': 'quente'
            },
            'MT': {
                'Cuiab√°': 'quente',
                'V√°rzea Grande': 'quente',
                'Rondon√≥polis': 'quente'
            },
            'MS': {
                'Campo Grande': 'quente',
                'Dourados': 'quente',
                'Tr√™s Lagoas': 'quente'
            },
            'MA': {
                'S√£o Lu√≠s': 'quente',
                'Imperatriz': 'quente',
                'Caxias': 'quente'
            },
            'RN': {
                'Natal': 'quente',
                'Mossor√≥': 'quente',
                'Parnamirim': 'quente'
            },
            'PB': {
                'Jo√£o Pessoa': 'quente',
                'Campina Grande': 'quente',
                'Santa Rita': 'quente'
            },
            'AL': {
                'Macei√≥': 'quente',
                'Arapiraca': 'quente'
            },
            'SE': {
                'Aracaju': 'quente',
                'Nossa Senhora do Socorro': 'quente'
            },
            'PI': {
                'Teresina': 'quente',
                'Parna√≠ba': 'quente'
            },
            'TO': {
                'Palmas': 'quente',
                'Aragua√≠na': 'quente'
            },
            'RO': {
                'Porto Velho': 'quente',
                'Ji-Paran√°': 'quente'
            },
            'AC': {
                'Rio Branco': 'quente',
                'Cruzeiro do Sul': 'quente'
            },
            'RR': {
                'Boa Vista': 'quente'
            },
            'AP': {
                'Macap√°': 'quente',
                'Santana': 'quente'
            }
        };

        const estadoSelect = document.getElementById('estado');
        const cidadeSelect = document.getElementById('cidade');
        
        if (estadoSelect && cidadeSelect) {
            // Quando mudar o estado, atualiza as cidades
            estadoSelect.addEventListener('change', function() {
                const estado = this.value;
                localStorage.setItem('estado', estado);
                
                // Limpa e desabilita cidade se n√£o selecionou estado
                if (!estado) {
                    cidadeSelect.innerHTML = '<option value="">Selecione o estado primeiro</option>';
                    cidadeSelect.disabled = true;
                    localStorage.removeItem('cidade');
                    return;
                }
                
                // Pega cidades do estado selecionado
                const cidades = cidadesPorEstado[estado] || {};
                const cidadesNomes = Object.keys(cidades).sort();
                
                // Popula dropdown de cidades
                cidadeSelect.innerHTML = '<option value="">Selecione sua cidade</option>';
                cidadesNomes.forEach(cidade => {
                    const option = document.createElement('option');
                    option.value = cidade;
                    option.textContent = cidade;
                    cidadeSelect.appendChild(option);
                });
                
                cidadeSelect.disabled = false;
                
                // Restaura cidade salva se for do mesmo estado
                const savedCidade = localStorage.getItem('cidade');
                if (savedCidade && cidadesNomes.includes(savedCidade)) {
                    cidadeSelect.value = savedCidade;
                }
            });
            
            // Salva cidade selecionada
            cidadeSelect.addEventListener('change', function() {
                localStorage.setItem('cidade', this.value);
            });
            
            // Restaura estado salvo
            const savedEstado = localStorage.getItem('estado');
            if (savedEstado) {
                estadoSelect.value = savedEstado;
                estadoSelect.dispatchEvent(new Event('change'));
            }
        }

        ['amb-fechado', 'amb-aberto', 'amb-ambos'].forEach(id => {
            const checkbox = document.getElementById(id);
            if (checkbox) {
                checkbox.addEventListener('change', function() {
                    localStorage.setItem(id, this.checked);
                });
                const saved = localStorage.getItem(id);
                if (saved === 'true') {
                    checkbox.checked = true;
                }
            }
        });

        // Prote√ß√£o anti-c√≥pia nas sugest√µes personalizadas
        document.addEventListener('DOMContentLoaded', function() {
            // Previne copiar, recortar e arrastar nas sugest√µes borradas
            document.addEventListener('copy', function(e) {
                const selection = window.getSelection().toString();
                // Bloqueia se a sele√ß√£o cont√©m texto das sugest√µes
                if (selection.includes('PRIORIDADE') || 
                    selection.includes('Dior Sauvage') || 
                    selection.includes('Acqua di Gio') || 
                    selection.includes('Spicebomb')) {
                    e.preventDefault();
                    return false;
                }
            });
            
            document.addEventListener('cut', function(e) {
                const selection = window.getSelection().toString();
                if (selection.includes('PRIORIDADE') || 
                    selection.includes('Dior Sauvage') || 
                    selection.includes('Acqua di Gio') || 
                    selection.includes('Spicebomb')) {
                    e.preventDefault();
                    return false;
                }
            });
        });
    </script>
</body>
</html>
